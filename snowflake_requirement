import snowflake.connector

conn = snowflake.connector.connect(
    user="haneefa",
    password="Snowflake@Password101!",
    account="cwpmobw-sw98951",
)
conn.cursor().execute("CREATE WAREHOUSE IF NOT EXISTS NUISANCE_WAREHOUSE")
conn.cursor().execute("USE WAREHOUSE NUISANCE_WAREHOUSE")
conn.cursor().execute("CREATE DATABASE IF NOT EXISTS NUISANCE_DATABASE")
conn.cursor().execute("USE DATABASE NUISANCE_DATABASE")
conn.cursor().execute("CREATE SCHEMA IF NOT EXISTS NUISANCE_SCHEMA")
conn.cursor().execute("USE SCHEMA NUISANCE_DATABASE.NUISANCE_SCHEMA")

conn.cursor().execute("create or replace TABLE "
"NUISANCE_TABLE (EVENTID VARCHAR(2000),YEAR INT,MONTH VARCHAR(2000),DAY VARCHAR(2000),COUNTRY_TXT VARCHAR(2000),REGION_TXT VARCHAR(2000),"
"PROVSTATE VARCHAR(2000),CITY VARCHAR(2000),MULTIPLE_INCIDENTSFLAG VARCHAR(2000),SUCCESSFLAG VARCHAR(2000),SUICIDEFLAG VARCHAR(2000),"
"EVENTNATURETYPE1 VARCHAR(2000),EVENTNATURETYPE2 VARCHAR(2000),EVENTNATURETYPE3 VARCHAR(2000),TARGETTYPE1 VARCHAR(2000),TARGET_SUBTYPE1 VARCHAR(2000),"
"TARGETNATIONALITY VARCHAR(2000),GROUP_RESPONSIBLE_NAME VARCHAR(2000),MOTIVE VARCHAR(2000),ATTACKERS VARCHAR(2000),ATTACKERSCAPTURED VARCHAR(2000),"
"CLAIMED VARCHAR(2000),CLAIMMODE_TXT VARCHAR(2000),MULTIPLEGROUPSCLAIMED VARCHAR(2000),WEAPONTYPE VARCHAR(2000),WEAPONSUBTYPE1 VARCHAR(2000),"
"WEAPONSUBTYPE2 VARCHAR(2000),KILLS VARCHAR(2000),USAKILLS VARCHAR(2000),ATTACKERSKILLED VARCHAR(2000),WOUNDED VARCHAR(2000),WOUNDSUS VARCHAR(2000),"
"ATTACKERSWOUNDED VARCHAR(2000),PROPERTYDAMAGEFLAG VARCHAR(2000),PROPERTYDAMAGEIMPACT VARCHAR(2000),PROPERTYVALUE VARCHAR(2000),HOSTAGEFLAG VARCHAR(2000),"
"HOSTAGES VARCHAR(2000),USHOSTAGES VARCHAR(2000),RANSOMFLAG VARCHAR(2000),RANSOMAMT VARCHAR(2000),RANSOMPAID VARCHAR(2000),HOSTKIDOUTCOME_TXT VARCHAR(2000),HOSTAGERELEASED VARCHAR(2000))"
)

# Putting Data
conn.cursor().execute("PUT file:///mnt/g/New.csv @%NUISANCE_EVENTS_TABLE")
conn.cursor().execute("COPY INTO NUISANCE_TABLE FILE_FORMAT=(type = csv record_delimiter = '\n' field_delimiter = ',' skip_header = 1 null_if = ('NULL', 'null') empty_field_as_null = true FIELD_OPTIONALLY_ENCLOSED_BY = '0x22')")
